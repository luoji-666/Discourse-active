:root { --bg: #121212; --accent: #bb86fc; }
body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg); color: #fff; overflow: hidden; user-select: none; }

/* === 瀑布流画廊 === */
#gallery-view { 
    height: 100vh; overflow-y: auto; padding: 20px; box-sizing: border-box; 
    /* 增加平滑滚动 */
    scroll-behavior: smooth;
}

header { text-align: center; margin-bottom: 30px; }
h1 { margin: 0; font-weight: 300; letter-spacing: 4px; background: linear-gradient(45deg, #bb86fc, #03dac6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
p { color: #888; font-size: 14px; margin-top: 5px; }

/* 核心瀑布流布局 */
.gallery { 
    column-count: 5; /* 默认5列 */
    column-gap: 15px; 
    max-width: 1400px; 
    margin: 0 auto; 
}

@media (max-width: 1200px) { .gallery { column-count: 4; } }
@media (max-width: 900px) { .gallery { column-count: 3; } }
@media (max-width: 600px) { .gallery { column-count: 2; } }

.card { 
    break-inside: avoid; /* 防止卡片被断开 */
    margin-bottom: 15px; 
    border-radius: 8px; 
    overflow: hidden; 
    position: relative; 
    background: #222;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    /* 关键：确保卡片本身有点击区域 */
    z-index: 1;
}

.card:hover { transform: scale(1.02); box-shadow: 0 5px 15px rgba(0,0,0,0.5); z-index: 2; }

/* 图片加载动效 */
.card img { width: 100%; display: block; opacity: 0; transition: opacity 0.5s; min-height: 150px; background: #333; }
.card img.loaded { opacity: 1; }

/* 底部加载条 */
#sentinel { text-align: center; padding: 40px; color: #666; display: flex; align-items: center; justify-content: center; gap: 10px; }
.loader { width: 20px; height: 20px; border: 2px solid #555; border-top-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

/* === 游戏区域 (保持深色高级感) === */
#game-area { display: none; width: 100vw; height: 100vh; position: relative; }

.toolbar {
    position: absolute; top: 0; left: 0; right: 0; height: 50px;
    background: rgba(18, 18, 18, 0.9); backdrop-filter: blur(10px);
    z-index: 200; border-bottom: 1px solid #333;
    display: flex; align-items: center; justify-content: center; gap: 20px;
}
.tool-btn { padding: 6px 16px; cursor: pointer; background: #333; color: #ddd; border: 1px solid #444; border-radius: 20px; font-size: 14px; transition: all 0.2s; }
.tool-btn:hover { background: var(--accent); color: #000; border-color: var(--accent); }
#progress-text { font-family: monospace; color: var(--accent); font-weight: bold; }

#board-container {
    width: 100%; height: 100%; overflow: auto; background: #1a1a1a;
    background-image: radial-gradient(#333 1px, transparent 1px); background-size: 30px 30px;
    display: flex; justify-content: center; align-items: center; padding: 80px 20px 20px 20px; box-sizing: border-box;
}

#play-board {
    position: relative; background-color: rgba(255, 255, 255, 0.03);
    border: 2px dashed #444; border-radius: 12px;
    transition: width 0.3s, height 0.3s; flex-shrink: 0;
}

.piece {
    position: absolute; cursor: grab; box-shadow: 1px 1px 5px rgba(0,0,0,0.5);
    transition: transform 0.1s; z-index: 10; box-sizing: border-box;
}
.piece.dragging { z-index: 1000 !important; cursor: grabbing; transform: scale(1.1); box-shadow: 0 10px 30px rgba(0,0,0,0.6); }

/* 弹窗 */
#modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); align-items: center; justify-content: center; z-index: 300; }
.modal-content { background: #222; color: #fff; padding: 30px; border-radius: 16px; text-align: center; width: 90%; max-width: 400px; border: 1px solid #333; }
.level-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 25px 0; }
.level-btn { background: #333; color: #eee; padding: 15px 5px; border-radius: 8px; border: 1px solid #444; cursor: pointer; font-size: 14px; transition: all 0.2s; }
.level-btn:hover { background: #444; border-color: var(--accent); }
.cancel-btn { background: none; border: none; color: #666; cursor: pointer; }
.cancel-btn:hover { color: #fff; }

#win-msg { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 3rem; color: #03dac6; z-index: 400; font-weight: bold; pointer-events: none; text-shadow: 0 0 20px rgba(3, 218, 198, 0.5); }